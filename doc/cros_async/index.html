<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `cros_async` crate."><meta name="keywords" content="rust, rustlang, rust-lang, cros_async"><title>cros_async - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings"></script><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../favicon.svg">
<link rel="alternate icon" type="image/png" href="../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../cros_async/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><p class="location">Crate cros_async</p><div class="block version"><p>Version 0.1.0</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all cros_async's items</p></a><div class="block items"><ul><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></div><p class="location"></p><div id="sidebar-vars" data-name="cros_async" data-ty="mod" data-relpath="../"></div></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="">cros_async</a></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/cros_async/lib.rs.html#5-510" title="goto source code">[src]</a></span></h1><div class="docblock"><p>An Executor and future combinators based on operations that block on file descriptors.</p>
<p>This crate is meant to be used with the <code>futures-rs</code> crate that provides further combinators
and utility functions to combine and manage futures. All futures will run until they block on a
file descriptor becoming readable or writable. Facilities are provided to register future
wakers based on such events.</p>
<h1 id="running-top-level-futures" class="section-header"><a href="#running-top-level-futures">Running top-level futures.</a></h1>
<p>Use helper functions based the desired behavior of your application.</p>
<h2 id="running-one-future" class="section-header"><a href="#running-one-future">Running one future.</a></h2>
<p>If there is only one top-level future to run, use the <a href="fn.run_one.html"><code>run_one</code></a> function.</p>
<h2 id="completing-one-of-several-futures" class="section-header"><a href="#completing-one-of-several-futures">Completing one of several futures.</a></h2>
<p>If there are several top level tasks that should run until any one completes, use the &quot;select&quot;
family of executor constructors. These return an <a href="trait.Executor.html"><code>Executor</code></a> whose <code>run</code>
function will return when the first future completes. The uncompleted futures will also be
returned so they can be run further or otherwise cleaned up. These functions are inspired by
the <code>select_all</code> function from futures-rs, but built to be run inside an FD based executor and
to poll only when necessary. See the docs for <a href="fn.select2.html"><code>select2</code></a>,
<a href="fn.select3.html"><code>select3</code></a>, <a href="fn.select4.html"><code>select4</code></a>, and <a href="fn.select5.html"><code>select5</code></a>.</p>
<h2 id="completing-all-of-several-futures" class="section-header"><a href="#completing-all-of-several-futures">Completing all of several futures.</a></h2>
<p>If there are several top level tasks that all need to be completed, use the &quot;complete&quot; family
of executor constructors. These return an <a href="trait.Executor.html"><code>Executor</code></a> whose <code>run</code>
function will return only once all the futures passed to it have completed. These functions are
inspired by the <code>join_all</code> function from futures-rs, but built to be run inside an FD based
executor and to poll only when necessary. See the docs for <a href="fn.complete2.html"><code>complete2</code></a>,
<a href="fn.complete3.html"><code>complete3</code></a>, <a href="fn.complete4.html"><code>complete4</code></a>, and
<a href="fn.complete5.html"><code>complete5</code></a>.</p>
<h1 id="implementing-new-fd-based-futures" class="section-header"><a href="#implementing-new-fd-based-futures">Implementing new FD-based futures.</a></h1>
<p>For URing implementations should provide an implementation of the <code>IoSource</code> trait.
For the FD executor, new futures can use the existing ability to poll a source to build async
functionality on top of.</p>
<h1 id="implementations-2" class="section-header"><a href="#implementations-2">Implementations</a></h1>
<p>Currently there are two paths for using the asynchronous IO. One uses a PollContext and drivers
futures based on the FDs signaling they are ready for the opteration. This method will exist so
long as kernels &lt; 5.4 are supported.
The other method submits operations to io_uring and is signaled when they complete. This is more
efficient, but only supported on kernel 5.4+.
If <code>IoSourceExt::new</code> is used to interface with async IO, then the correct backend will be chosen
automatically.</p>
<h1 id="examples" class="section-header"><a href="#examples">Examples</a></h1>
<p>See the docs for <code>IoSourceExt</code> if support for kernels &lt;5.4 is required. Focus on <code>UringSource</code> if
all systems have support for io_uring.</p>
</div><h2 id="reexports" class="section-header"><a href="#reexports">Re-exports</a></h2>
<table><tr><td><code>pub use mem::<a class="trait" href="../cros_async/mem/trait.BackingMemory.html" title="trait cros_async::mem::BackingMemory">BackingMemory</a>;</code></td></tr><tr><td><code>pub use mem::<a class="struct" href="../cros_async/mem/struct.MemRegion.html" title="struct cros_async::mem::MemRegion">MemRegion</a>;</code></td></tr><tr><td><code>pub use <a class="mod" href="../sys_util/index.html" title="mod sys_util">sys_util</a>;</code></td></tr></table><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<table><tr class="module-item"><td><a class="mod" href="mem/index.html" title="cros_async::mem mod">mem</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="mod" href="sync/index.html" title="cros_async::sync mod">sync</a></td><td class="docblock-short"></td></tr></table><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.AsyncWrapper.html" title="cros_async::AsyncWrapper struct">AsyncWrapper</a></td><td class="docblock-short"><p>Simple wrapper struct to implement IntoAsync on foreign types.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.BlockingPool.html" title="cros_async::BlockingPool struct">BlockingPool</a></td><td class="docblock-short"><p>A thread pool for running work that may block.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Empty.html" title="cros_async::Empty struct">Empty</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.EventAsync.html" title="cros_async::EventAsync struct">EventAsync</a></td><td class="docblock-short"><p>An async version of <code>sys_util::EventFd</code>.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FdExecutor.html" title="cros_async::FdExecutor struct">FdExecutor</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.PollSource.html" title="cros_async::PollSource struct">PollSource</a></td><td class="docblock-short"><p>Async wrapper for an IO source that uses the FD executor to drive async operations.
Used by <code>IoSourceExt::new</code> when uring isn't available.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.TimerAsync.html" title="cros_async::TimerAsync struct">TimerAsync</a></td><td class="docblock-short"><p>An async version of sys_util::TimerFd.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.URingExecutor.html" title="cros_async::URingExecutor struct">URingExecutor</a></td><td class="docblock-short"><p>An executor that uses io_uring for its asynchronous I/O operations. See the documentation of
<code>Executor</code> for more details about the methods.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.UringSource.html" title="cros_async::UringSource struct">UringSource</a></td><td class="docblock-short"><p><code>UringSource</code> wraps FD backed IO sources for use with io_uring. It is a thin wrapper around
registering an IO source with the uring that provides an <code>IoSource</code> implementation.
Most useful functions are provided by 'IoSourceExt'.</p>
</td></tr></table><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<table><tr class="module-item"><td><a class="enum" href="enum.AsyncError.html" title="cros_async::AsyncError enum">AsyncError</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="enum" href="enum.Error.html" title="cros_async::Error enum">Error</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="enum" href="enum.Executor.html" title="cros_async::Executor enum">Executor</a></td><td class="docblock-short"><p>An executor for scheduling tasks that poll futures to completion.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.SelectResult.html" title="cros_async::SelectResult enum">SelectResult</a></td><td class="docblock-short"></td></tr></table><h2 id="traits" class="section-header"><a href="#traits">Traits</a></h2>
<table><tr class="module-item"><td><a class="trait" href="trait.IntoAsync.html" title="cros_async::IntoAsync trait">IntoAsync</a></td><td class="docblock-short"><p>Marker trait signifying that the implementor is suitable for use with
cros_async. Examples of this include File, and sys_util::net::UnixSeqpacket.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.IoSourceExt.html" title="cros_async::IoSourceExt trait">IoSourceExt</a></td><td class="docblock-short"><p>Subtrait for general async IO.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.ReadAsync.html" title="cros_async::ReadAsync trait">ReadAsync</a></td><td class="docblock-short"><p>Ergonomic methods for async reads.</p>
</td></tr><tr class="module-item"><td><a class="trait" href="trait.WriteAsync.html" title="cros_async::WriteAsync trait">WriteAsync</a></td><td class="docblock-short"><p>Ergonomic methods for async writes.</p>
</td></tr></table><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<table><tr class="module-item"><td><a class="fn" href="fn.block_on.html" title="cros_async::block_on fn">block_on</a></td><td class="docblock-short"><p>Run a future to completion on the current thread.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.complete2.html" title="cros_async::complete2 fn">complete2</a></td><td class="docblock-short"><p>Creates a combinator that runs the two given futures to completion, returning a tuple of the
outputs each yields.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.complete3.html" title="cros_async::complete3 fn">complete3</a></td><td class="docblock-short"><p>Creates a combinator that runs the three given futures to completion, returning a tuple of the
outputs each yields.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.complete4.html" title="cros_async::complete4 fn">complete4</a></td><td class="docblock-short"><p>Creates a combinator that runs the four given futures to completion, returning a tuple of the
outputs each yields.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.complete5.html" title="cros_async::complete5 fn">complete5</a></td><td class="docblock-short"><p>Creates a combinator that runs the five given futures to completion, returning a tuple of the
outputs each yields.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.empty.html" title="cros_async::empty fn">empty</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="fn" href="fn.run_one.html" title="cros_async::run_one fn">run_one</a></td><td class="docblock-short"><p>Creates an Executor that runs one future to completion.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.run_one_poll.html" title="cros_async::run_one_poll fn">run_one_poll</a></td><td class="docblock-short"><p>Creates a FdExecutor that runs one future to completion.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.run_one_uring.html" title="cros_async::run_one_uring fn">run_one_uring</a></td><td class="docblock-short"><p>Creates a URingExecutor that runs one future to completion.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.select2.html" title="cros_async::select2 fn">select2</a></td><td class="docblock-short"><p>Creates a combinator that runs the two given futures until one completes, returning a tuple
containing the result of the finished future and the still pending future.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.select3.html" title="cros_async::select3 fn">select3</a></td><td class="docblock-short"><p>Creates a combinator that runs the three given futures until one or more completes, returning a
tuple containing the result of the finished future(s) and the still pending future(s).</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.select4.html" title="cros_async::select4 fn">select4</a></td><td class="docblock-short"><p>Creates a combinator that runs the four given futures until one or more completes, returning a
tuple containing the result of the finished future(s) and the still pending future(s).</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.select5.html" title="cros_async::select5 fn">select5</a></td><td class="docblock-short"><p>Creates a combinator that runs the five given futures until one or more completes, returning a
tuple containing the result of the finished future(s) and the still pending future(s).</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.select6.html" title="cros_async::select6 fn">select6</a></td><td class="docblock-short"><p>Creates a combinator that runs the six given futures until one or more completes, returning a
tuple containing the result of the finished future(s) and the still pending future(s).</p>
</td></tr></table><h2 id="types" class="section-header"><a href="#types">Type Definitions</a></h2>
<table><tr class="module-item"><td><a class="type" href="type.AsyncResult.html" title="cros_async::AsyncResult type">AsyncResult</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="type" href="type.Result.html" title="cros_async::Result type">Result</a></td><td class="docblock-short"></td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="cros_async"></div>
    <script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>